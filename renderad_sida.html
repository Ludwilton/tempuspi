<!DOCTYPE html>
<html lang="sv">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=480, height=800, initial-scale=1.0">
    <title>Brutalist Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <link href="https://fonts.googleapis.com/css2?family=Space+Mono:ital,wght@0,400;0,700;1,400&family=Archivo+Black&display=swap" rel="stylesheet">
    
    <style>
        /* GLOBAL RESET & FONTS */
        html, body {
            width: 480px;
            height: 800px;
            margin: 0; padding: 0;
            overflow: hidden;
            background-color: white;
            color: black;
            font-family: 'Space Mono', monospace;
        }
        
        .font-display { font-family: 'Archivo Black', sans-serif; }

        /* Brutalist Borders */
        .b-b { border-bottom: 3px solid black; }
        .b-t { border-top: 3px solid black; }
        .b-r { border-right: 3px solid black; }
        .b-l { border-left: 3px solid black; }
        .b-all { border: 3px solid black; }

        .inverted { background-color: black; color: white; }
        .grid-line { border-top: 1px dashed black; }
        
        .no-scrollbar::-webkit-scrollbar { display: none; }
    </style>
</head>
<body class="flex flex-col border-[6px] border-black box-border">

    <header class="flex flex-col shrink-0 h-[160px]">
        
        <div class="flex h-[40px] b-b">
            <div class="inverted flex-1 flex items-center px-2 text-sm font-bold uppercase tracking-widest">
                Torsdag 4 Dec
            </div>
            <div class="px-2 flex items-center text-xs font-bold b-l bg-white">
                SYS.RDY // 2025
            </div>
        </div>

        <div class="flex flex-1 items-center justify-between px-2">
            <div class="font-display text-[5.5rem] leading-none tracking-tighter -ml-1">
                16:23
            </div>
            
            <div class="flex flex-col items-end justify-center h-full pl-4">
                <div class="flex items-center">
                    <span class="font-display text-4xl mr-2">5.6°</span>
                    <i data-lucide="cloud-drizzle" class="w-8 h-8 stroke-[3]"></i>
                </div>
                <div class="text-xs font-bold uppercase tracking-widest mt-1 border-t-2 border-black pt-1 w-full text-right">
                    GBG_SE
                </div>
            </div>
        </div>
    </header>

    <div class="h-[30px] b-t b-b flex items-center px-2 bg-gray-100">
        <span class="text-xs font-bold uppercase tracking-widest">/// WEEK_SCHEDULE_V1.0</span>
    </div>

    <section class="flex flex-col relative h-[350px] shrink-0 overflow-hidden">
        <div class="flex b-b h-[25px] text-xs font-bold" id="calendar-header"></div>
        
        <div class="relative w-full h-full" id="calendar-body">
            <div class="absolute inset-0 pointer-events-none z-0 flex flex-col justify-between py-1 pl-1 opacity-40">
                <div class="text-[9px] grid-line w-full pt-0.5">06:00</div>
                <div class="text-[9px] grid-line w-full pt-0.5">09:00</div>
                <div class="text-[9px] grid-line w-full pt-0.5">12:00</div>
                <div class="text-[9px] grid-line w-full pt-0.5">15:00</div>
                <div class="text-[9px] grid-line w-full pt-0.5">18:00</div>
                <div class="text-[9px] grid-line w-full pt-0.5">21:00</div>
            </div>
            <div id="calendar-columns" class="flex w-full h-full z-10 absolute inset-0"></div>
        </div>
    </section>

    <div class="h-[35px] b-t b-b flex items-center justify-between px-2 bg-black text-white">
        <span class="text-sm font-bold uppercase tracking-widest truncate flex-1">
            >> Doktor Fries Torg
        </span>
        <div class="flex text-xs">
            <span class="w-24 text-right pr-2">NEXT_DEP</span>
            <span class="w-20 text-right pr-2">LATER</span>
        </div>
    </div>

    <section class="flex-col bg-white w-full flex-1 overflow-hidden flex pb-0 min-h-0">
        <div id="bus-list" class="flex flex-col w-full">
            
                
                
                <div class="flex items-center border-b-2 border-black px-2 h-[60px] shrink-0 w-full hover:bg-gray-100">
                    
                    <div class="w-12 shrink-0 mr-3 flex justify-center">
                        <span class="inline-flex items-center justify-center bg-black text-white font-display text-xl h-10 w-10 border-2 border-black">
                            10
                        </span>
                    </div>
                    
                    <div class="flex-1 text-lg font-bold uppercase truncate leading-tight pr-2 tracking-tight">
                        Biskopsgården
                    </div>
                    
                    <div class="w-24 shrink-0 text-right font-display text-2xl pr-2 leading-none">
                        5
                    </div>

                    <div class="w-20 shrink-0 text-right font-bold text-sm text-gray-600 pr-2 leading-none border-l-2 border-black h-full flex items-center justify-end">
                        14
                    </div>
                </div>
                
                
                <div class="flex items-center border-b-2 border-black px-2 h-[60px] shrink-0 w-full hover:bg-gray-100">
                    
                    <div class="w-12 shrink-0 mr-3 flex justify-center">
                        <span class="inline-flex items-center justify-center bg-black text-white font-display text-xl h-10 w-10 border-2 border-black">
                            10
                        </span>
                    </div>
                    
                    <div class="flex-1 text-lg font-bold uppercase truncate leading-tight pr-2 tracking-tight">
                        Brämaregården
                    </div>
                    
                    <div class="w-24 shrink-0 text-right font-display text-2xl pr-2 leading-none">
                        18:18
                    </div>

                    <div class="w-20 shrink-0 text-right font-bold text-sm text-gray-600 pr-2 leading-none border-l-2 border-black h-full flex items-center justify-end">
                        18:28
                    </div>
                </div>
                
                
                <div class="flex items-center border-b-2 border-black px-2 h-[60px] shrink-0 w-full hover:bg-gray-100">
                    
                    <div class="w-12 shrink-0 mr-3 flex justify-center">
                        <span class="inline-flex items-center justify-center bg-black text-white font-display text-xl h-10 w-10 border-2 border-black">
                            X
                        </span>
                    </div>
                    
                    <div class="flex-1 text-lg font-bold uppercase truncate leading-tight pr-2 tracking-tight">
                        Jaegerdorffsplatsen
                    </div>
                    
                    <div class="w-24 shrink-0 text-right font-display text-2xl pr-2 leading-none">
                        18:44
                    </div>

                    <div class="w-20 shrink-0 text-right font-bold text-sm text-gray-600 pr-2 leading-none border-l-2 border-black h-full flex items-center justify-end">
                        
                    </div>
                </div>
                
            
        </div>
    </section>

    <script>
        // Lucide loading fix
        window.onload = function() {
            if (window.lucide) { lucide.createIcons(); } 
            else { setTimeout(() => { if (window.lucide) lucide.createIcons(); }, 500); }
        };

        const daysFromPython = [{"events": [{"end": 12.0, "name": "test", "start": 11.0}], "is_today": false, "namn": "M"}, {"events": [], "is_today": false, "namn": "T"}, {"events": [{"end": 11.25, "name": "test4!", "start": 10.25}], "is_today": false, "namn": "O"}, {"events": [{"end": 16.0, "name": "Djup maskininl\u00e4rning, 10yhp", "start": 9.0}, {"end": 18.25, "name": "test6", "start": 16.75}], "is_today": true, "namn": "T"}, {"events": [{"end": 19.0, "name": "test2", "start": 14.5}], "is_today": false, "namn": "F"}, {"events": [{"end": 22.25, "name": "test3", "start": 17.5}], "is_today": false, "namn": "L"}, {"events": [], "is_today": false, "namn": "S"}];

        function renderCalendar() {
            const headerContainer = document.getElementById('calendar-header');
            const columnsContainer = document.getElementById('calendar-columns');
            const startHour = 6;
            const totalHours = 18; 
            
            function getTopPercent(hour) {
                if (!hour) return 0;
                if (hour < startHour) return 0; 
                if (hour > 24) return 100;     
                return ((hour - startHour) / totalHours) * 100;
            }

            let headerHtml = '';
            let columnsHtml = '';

            daysFromPython.forEach((dayData) => {
                const isToday = dayData.is_today;
                const widthClass = isToday ? 'w-5/12' : 'flex-1'; 
                const bgClass = isToday ? 'bg-black text-white' : 'bg-white text-black';
                const borderClass = 'border-r-2 border-black'; 
                
                headerHtml += `
                    <div class="${widthClass} text-center py-1 ${borderClass} ${bgClass} h-full flex items-center justify-center uppercase">
                        ${dayData.namn}
                    </div>
                `;

                let dayEventsHtml = '';
                
                // HÄR ÄR ÄNDRINGEN: Loopar igenom events-listan
                if (dayData.events && dayData.events.length > 0) {
                    dayData.events.forEach((evt) => {
                        const start = evt.start || 8; 
                        const end = evt.end || 9;
                        const top = getTopPercent(start);
                        let height = ((end - start) / totalHours) * 100;
                        if (height < 5) height = 5; 

                        if (isToday) {
                            // Brutalist Style: Vit box med tjock svart kant och hård skugga
                            dayEventsHtml += `
                                <div class="absolute w-full px-1 z-20" style="top: ${top}%; height: ${height}%;">
                                    <div class="bg-white text-black h-full w-full border-[3px] border-black p-1 overflow-hidden flex flex-col justify-center shadow-[4px_4px_0px_0px_rgba(0,0,0,1)] relative">
                                        <span class="font-bold truncate text-[10px] leading-tight uppercase font-mono">${evt.name}</span>
                                    </div>
                                </div>
                            `;
                        } else {
                            // Brutalist Style: Solid svart block
                            dayEventsHtml += `
                                <div class="absolute w-full flex justify-center z-10 px-0.5" style="top: ${top}%; height: ${height}%;">
                                    <div class="bg-black w-full h-full opacity-100 border border-black" title="${evt.name}"></div>
                                </div>
                            `;
                        }
                    });
                }

                columnsHtml += `
                    <div class="${widthClass} relative ${borderClass} h-full">
                        ${dayEventsHtml}
                    </div>
                `;
            });

            headerContainer.innerHTML = headerHtml;
            columnsContainer.innerHTML = columnsHtml;
        }

        if (daysFromPython && daysFromPython.length > 0) renderCalendar();
    </script>
</body>
</html>