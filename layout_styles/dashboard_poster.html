<!DOCTYPE html>
<html lang="sv">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=480, height=800, initial-scale=1.0">
    <title>Dashboard</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Archivo+Black&family=Space+Grotesk:wght@700&family=Courier+Prime:wght@400;700&display=swap');
        
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            width: 480px;
            height: 800px;
            overflow: hidden;
            background: #ffffff;
            position: relative;
        }
        
        body::after {
            content: '';
            position: fixed;
            inset: 0;
            background: repeating-linear-gradient(
                0deg, 
                transparent, 
                transparent 2px, 
                rgba(0,0,0,0.015) 2px, 
                rgba(0,0,0,0.015) 4px
            );
            pointer-events: none;
            z-index: 9999;
        }
        
        .archivo { font-family: 'Archivo Black', sans-serif; }
        .grotesk { font-family: 'Space Grotesk', sans-serif; font-weight: 700; }
        .courier { font-family: 'Courier Prime', monospace; }
        
        .statement-time {
            font-size: 280px;
            line-height: 0.75;
            letter-spacing: -0.08em;
            writing-mode: vertical-rl;
            text-orientation: mixed;
            transform: rotate(180deg);
        }
        
        .vertical-text {
            writing-mode: vertical-rl;
            text-orientation: mixed;
        }
        
        .event-strip {
            background: #000;
            color: #fff;
            position: absolute;
            display: flex;
            align-items: center;
            padding: 4px 6px;
            font-size: 7px;
            font-weight: 700;
            line-height: 1.2;
            overflow: hidden;
            clip-path: polygon(0 0, 100% 0, 98% 100%, 0 100%);
        }
        
        .transit-minimal {
            position: relative;
            padding: 12px 0;
            border-bottom: 1px solid rgba(0,0,0,0.15);
        }
        
        .transit-minimal:last-child {
            border-bottom: none;
        }
        
        .transit-num-block {
            background: #000;
            color: #fff;
            padding: 8px 12px;
            font-size: 32px;
            line-height: 1;
            clip-path: polygon(0 0, 100% 0, 95% 100%, 0 100%);
            min-width: 70px;
            text-align: center;
        }
        
        .diagonal-accent {
            position: absolute;
            background: #000;
            height: 2px;
            transform-origin: left center;
        }
    </style>
</head>
<body>
    
    <div class="relative w-full h-full text-black"><div class="absolute inset-0 flex"><div class="relative flex items-center justify-center" style="width: 200px;">

                <div class="statement-time archivo" style="color: #000; font-size: 240px;">
                    {{ klockslag }}
                </div>
                
                <div class="absolute bottom-8 left-8">
                    <div class="text-5xl archivo leading-none">{{ vader_temp }}Â°</div>
                    <div class="text-[8px] courier tracking-widest opacity-40 mt-1">TEMP</div>
                </div>
                
                <div class="absolute top-8 left-8 vertical-text">
                    <div class="text-sm grotesk tracking-widest opacity-60 mb-2">{{ datum_dag|upper }}</div>
                    <div class="text-4xl archivo leading-none">{{ datum_manad[:3]|upper }}</div>
                </div>
            </div>
            
            <div class="flex-1 flex flex-col p-8 relative" style="padding-left: 24px;">
                
                {% if spotify and spotify.is_playing %}

                    <div class="mb-6 pb-6" style="border-bottom: 2px solid rgba(0,0,0,0.2);">
                        <div class="text-[9px] courier tracking-widest opacity-50 mb-4">CURRENTLY</div>
                        
                        <div class="flex gap-4">
                            {% if spotify.image %}
                                <img src="{{ spotify.image }}" class="w-28 h-28 object-cover grayscale brightness-110 contrast-125" style="border: 3px solid #000;">
                            {% else %}
                                <div class="w-28 h-28 bg-black border-3 border-black"></div>
                            {% endif %}
                            
                            <div class="flex-1 flex flex-col justify-center">
                                <div class="text-base archivo leading-tight mb-2">{{ spotify.track|upper }}</div>
                                <div class="text-xs grotesk opacity-70 mb-1">{{ spotify.artist }}</div>
                                <div class="text-[10px] courier opacity-40">{{ spotify.album }}</div>
                            </div>
                        </div>
                    </div>
                {% endif %}
                
                <div class="flex-1 mb-6 min-h-0">
                    <div class="text-[10px] courier tracking-widest mb-4 opacity-50">THIS WEEK</div>
                    
                    <div class="h-full flex gap-[3px] relative">
                        <div class="absolute left-0 right-0 top-0 h-full pointer-events-none" style="z-index: 0;">
                            <div class="absolute left-0 right-0 h-px bg-black opacity-10" style="top: 25%;"></div>
                            <div class="absolute left-0 right-0 h-px bg-black opacity-10" style="top: 50%;"></div>
                            <div class="absolute left-0 right-0 h-px bg-black opacity-10" style="top: 75%;"></div>
                        </div>
                        
                        {% if kalender_dagar %}
                            {% for day in kalender_dagar %}
                            <div class="flex-1 relative" style="z-index: 1;">
                                    {{ day.namn[0] }}
                                </div>
                                
                                <div class="h-full relative" style="border-left: 1px solid rgba(0,0,0,0.1);">
                                    {% if day.events %}
                                        {% for event in day.events %}
                                            {% set start_pct = ((event.start - 6) / 18 * 100) if event.start else 0 %}
                                            {% set duration = (event.end - event.start) if (event.end and event.start) else 1 %}
                                            {% set height_pct = (duration / 18 * 100) %}
                                            
                                            <div class="event-strip courier absolute" 
                                                 style="
                                                    top: {{ start_pct }}%; 
                                                    height: max({{ height_pct }}%, 20px);
                                                    left: 2px;
                                                    right: 2px;
                                                 ">
                                                {{ event.name|upper }}
                                            </div>
                                        {% endfor %}
                                    {% endif %}
                                </div>
                            </div>
                            {% endfor %}
                        {% else %}
                            <div class="flex items-center justify-center w-full text-[10px] courier opacity-20">
                                NO EVENTS
                            </div>
                        {% endif %}
                    </div>
                </div>
                
                <div>
                    <div class="flex items-center gap-2 mb-4">
                        <div class="text-[10px] courier tracking-widest opacity-50">
                            {{ hallplats_namn|upper|default('TRANSIT') }}
                        </div>
                        <div class="flex-1 h-px bg-black opacity-20"></div>
                    </div>
                    
                    {% if avgangar %}
                        <div class="space-y-1">
                            {% for bus in avgangar[:3] %}
                            <div class="transit-minimal">
                                <div class="flex items-center justify-between mb-2">
                                    
                                    <div class="text-right shrink-0">
                                        <div class="text-4xl archivo tabular-nums leading-none">{{ bus.next }}</div>
                                        <div class="text-[9px] courier opacity-40 mt-1">+{{ bus.later }}</div>
                                    </div>
                                </div>
                                
                                <div class="text-sm grotesk uppercase pl-1">{{ bus.destination }}</div>
                            </div>
                            {% endfor %}
                        </div>
                    {% else %}
                        <div class="text-[10px] courier opacity-20 text-center py-8">NO DEPARTURES</div>
                    {% endif %}
                </div>
            </div>
        </div>
        
        <div class="diagonal-accent" style="top: 15%; left: 0; width: 60%; transform: rotate(-2deg);"></div>
        <div class="diagonal-accent" style="bottom: 25%; right: 0; width: 40%; transform: rotate(1deg);"></div>
        
        <div class="absolute top-4 left-4 w-8 h-8 border-l border-t border-black opacity-30"></div>
        <div class="absolute top-4 right-4 w-8 h-8 border-r border-t border-black opacity-30"></div>
        <div class="absolute bottom-4 left-4 w-8 h-8 border-l border-b border-black opacity-30"></div>
        <div class="absolute bottom-4 right-4 w-8 h-8 border-r border-b border-black opacity-30"></div>
        
    </div>

    <script>
        window.onload = function() {
            if (window.lucide) { lucide.createIcons(); } 
            else { setTimeout(() => { if (window.lucide) lucide.createIcons(); }, 500); }
        };
    </script>
</body>
</html>